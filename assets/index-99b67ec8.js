(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();const D=["https://brasilapi.com.br/api/cep/v2/","https://cep.awesomeapi.com.br/json/"],P=document.querySelector(".cart__address"),H=async t=>(await Promise.any(D.map(async e=>fetch(`${e}${t}`)))).json(),W=async t=>{try{const e=await H(t);if(!e.address&&!e.street)throw new Error("CEP não encontrado");const r=e.address??e.street,s=e.district??e.neighborhood;P.innerHTML=`${r} - ${s} - ${e.city} - ${e.state}`}catch(e){console.error(e),P.innerHTML="CEP não encontrado"}},_=["https://api.mercadolibre.com/sites/MLB/search?","https://api.mercadolibre.com/items/","https://api.mercadolibre.com/sites/MLB/categories"],$=async t=>{if(!t)throw new Error("ID não informado");return(await fetch(`${_[1]}${t}`)).json()},j=async(t,e)=>{if(!t)throw new Error("Termo de busca não informado");return(await(await fetch(`${_[0]}${e}=${t}`)).json()).results},A=async()=>(await fetch(_[2])).json(),v=()=>{const t=localStorage.getItem("cartProducts");return t?JSON.parse(t):[]},J=t=>{if(!t)throw new Error("Você deve fornecer um ID");const r=[...v(),t];localStorage.setItem("cartProducts",JSON.stringify(r))},U=t=>{if(!t)throw new Error("Você deve fornecer um ID");const e=[...v()],r=e.indexOf(t);e.splice(r,1),localStorage.setItem("cartProducts",JSON.stringify(e))},f=t=>{const e=document.createElement("img");return e.className="product__image",e.src=t.replace("I.jpg","O.jpg"),e},c=(t,e,r="")=>{const s=document.createElement(t);return s.className=e,s.innerText=r,s},F=(t,e)=>{t.remove(),U(e)},N=t=>{const e=typeof t=="number"?t.toString():t;return e.includes(".")?e[e.length-2]==="."?`${e}0`:e:`${e}.00`},T=({id:t,title:e,price:r,pictures:s})=>{const n=document.createElement("li");n.className="cart__product";const o=c("div","cart__product__image-container"),i=f(s[0].url);o.appendChild(i);const y=f((s[1]||s[0]).url);o.appendChild(y),n.appendChild(o);const h=c("div","cart__product__info-container");h.appendChild(c("span","product__title",e));const b=c("span","product__price","R$ ");b.appendChild(c("span","product__price__value",N(r))),h.appendChild(b),n.appendChild(h);const R=c("i","material-icons cart__product__remove","delete");return n.appendChild(R),n.addEventListener("click",()=>F(n,t)),n},V=({id:t,title:e,thumbnail:r,price:s})=>{const n=document.createElement("section");n.className="product",n.appendChild(c("span","product__id",t));const o=c("div","img__container");o.appendChild(f(r)),n.appendChild(o),n.appendChild(c("span","product__title",e));const i=c("span","product__price","R$ ");i.appendChild(c("span","product__price__value",N(s))),n.appendChild(i);const y=c("button","product__add","Adicionar ao carrinho!");return n.appendChild(y),n};const a=document.querySelector(".products"),x=document.querySelector("ol.cart__products"),z=document.querySelector(".total-price"),u=document.querySelector(".count-itens"),K=document.querySelector(".container-cartTitle"),Q=document.querySelector(".input-group"),p=document.getElementById("category-title"),k=document.getElementById("input-label"),m=document.getElementById("search"),d=document.getElementById("container-categories"),S=document.getElementById("list-categories"),l=document.querySelector(".cart"),g=document.querySelector(".container-title"),C=900,B=550,w=["category","q"],I=t=>t?`<section class="loading">
        <button class="btn" type="button" disabled>
          <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true">
          </span>
          Carregando...
        </button>
      </section>`:"",M=()=>{const t=document.querySelectorAll(".cart__product__info-container"),e=[...t];z.innerHTML=e.reduce((r,s,n)=>{const o=Number(t[n].lastChild.lastChild.innerText);return r+o},0).toFixed(2)},q=()=>{const t=document.querySelectorAll(".cart__product__info-container");t.length?(u.innerHTML=t.length,u.style.display="block"):(u.innerHTML=0,u.style.display="none",l.style.display="none",a.style.marginRight="0")},G=async()=>{const t=v();(await Promise.all(t.map(async r=>$(r)))).forEach(r=>{x.appendChild(T(r))}),M(),q()},O=t=>{a.innerHTML=`<section class="error">
  ${t.message}. Recarregue a página ou tente novamente!
  </section>`,console.error(t)},X=async()=>{const t=await A();S.innerHTML="",t.forEach(({id:e,name:r})=>{S.innerHTML+=`<li class="category">${r}
    <span class="id-category">${e}</span></li>`})},L=t=>{let e=JSON.parse(localStorage.getItem("preferences"));e?e[t]=e[t]?e[t]+1:1:e={[t]:1},localStorage.setItem("preferences",JSON.stringify(e))},Y=t=>Math.round(Math.random()*t),E=async(t="computador",e)=>{a.innerHTML=I(!0);const r=await j(t,e);if(a.innerHTML=I(!1),!r.length)throw new Error("Busca inválida! Item não encontrado/existe");r.forEach(s=>a.appendChild(V(s)))},Z=async t=>{const e=t.parentNode.firstChild.innerText;J(e);const r=await $(e);L(r.category_id),x.appendChild(T(r))};(async function(){try{await X();const e=JSON.parse(localStorage.getItem("preferences"));let r;if(e)[r]=Object.entries(e).reduce((n,[o,i])=>i>n[1]?[o,i]:n,["",0]);else{const n=document.getElementsByClassName("id-category"),o=Y(n.length-1);r=n[o].innerText}const s=r.includes("MLB")?0:1;await E(r,w[s]),await G()}catch(e){O(e)}})();Q.addEventListener("submit",async t=>{t.preventDefault();try{const{value:e}=document.getElementById("search");await E(e,w[1]),L(e)}catch(e){O(e)}});document.addEventListener("click",async t=>{const e=t.target;if(e.classList.contains("product__add")&&await Z(e),e.classList.contains("category")){await E(e.lastChild.innerText,w[0]),L(e.lastChild.innerText),d.style.display="none";const r=d.style.display==="none";window.innerWidth>C&&(a.style.marginLeft=r?`${d.clientWidth}px`:"0")}else M(),q()});document.querySelector(".cep-button").addEventListener("click",async()=>{const{value:t}=document.querySelector(".cep-input");await W(t)});K.addEventListener("click",()=>{const t=l.style.display==="none";Number(u.innerText)&&(l.style.display=t?"flex":"none",window.innerWidth>C?a.style.marginRight=t?`${l.clientWidth}px`:"0":d.style.display=d.style.display!=="none"&&"none")});p.addEventListener("click",()=>{const t=d.style.display==="none";d.style.display=t?"block":"none",p.classList.contains("open")?p.classList.remove("open"):p.classList.add("open"),window.innerWidth>C?a.style.marginLeft=t?`${d.clientWidth}px`:"0":l.style.display=l.style.display!=="none"&&"none"});k.addEventListener("click",t=>{t.preventDefault(),window.innerWidth<=B&&(m.classList.contains("invisibleResponse")?(m.classList.remove("invisibleResponse"),m.focus(),g.classList.add("invisibleResponse")):(m.classList.add("invisibleResponse"),g.classList.remove("invisibleResponse")))});window.addEventListener("resize",()=>{window.innerWidth>B&&p.classList.contains("invisibleResponse")&&(g.classList.remove("invisibleResponse"),m.classList.add("invisibleResponse"))});
